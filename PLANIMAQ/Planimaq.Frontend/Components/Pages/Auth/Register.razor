@page "/Register"
@using Planimaq.Shared.Entities
@using Planimaq.Shared.Enums

@if (loading)
{
    <Loading />
}
else
{
    <EditForm Model="userDTO"
              OnValidSubmit="CreateUserAsync"
              OnInvalidSubmit="InvalidForm"
              FormName="RegisterForm">
        <DataAnnotationsValidator />
        <MudGrid>
            <MudItem xs="12" sm="6">
                <MudCardContent>
                    <MudTextField Label="Nombre"
                                  @bind-Value="userDTO.FirstName"
                                  For="@(() => userDTO.FirstName)" />
                    <MudTextField Label="Apellido"
                                  @bind-Value="userDTO.LastName"
                                  For="@(() => userDTO.LastName)" />
                    <MudTextField Label="Documento"
                                  @bind-Value="userDTO.Document"
                                  For="@(() => userDTO.Document)" />
                    <MudTextField Label="Telefono"
                                  @bind-Value="userDTO.PhoneNumber"
                                  For="@(() => userDTO.PhoneNumber)"
                                  InputType="InputType.Telephone" />
                    <MudTextField Label="Usuario"
                                  @bind-Value="userDTO.Email"
                                  For="@(() => userDTO.Email)"
                                  InputType="InputType.Email" />
                    <MudTextField Label="Contraseña"
                                  InputType="InputType.Password"
                                  @bind-Value="userDTO.Password"
                                  For="@(() => userDTO.Password)" />
                    <MudTextField Label="Confirmar Contraseña"
                                  InputType="InputType.Password"
                                  @bind-Value="userDTO.PasswordConfirm"
                                  For="@(() => userDTO.PasswordConfirm)" />
                    <MudTextField Label="Rol"
                                  InputType="InputType.Text"
                                  @bind-Value="userDTO.FechaNacimiento"
                                  For="@(() => userDTO.FechaNacimiento)" />
                    <MudTextField Label="F.Nacimiento"
                                  InputType="InputType.Date"
                                  @bind-Value="userDTO.FechaNacimiento"
                                  For="@(() => userDTO.FechaNacimiento)" />
                    <MudTextField Label="Especialidad"
                                  @bind-Value="userDTO.Especialidad"
                                  For="@(() => userDTO.Especialidad)" />
                    <MudTextField Label="Brevete"
                                  @bind-Value="userDTO.Brevete"
                                  For="@(() => userDTO.Brevete)" />
                    <MudTextField Label="Nacionalidad"
                                  @bind-Value="userDTO.Nacionalidad"
                                  For="@(() => userDTO.Nacionalidad)" />

                </MudCardContent>
            </MudItem>
            <MudItem xs="12" sm="6">
                <MudCardContent>
                    <MudTextField Label="Característica"
                                  @bind-Value="userDTO.CaracteristicaA"
                                  For="@(() => userDTO.CaracteristicaA)" />
                    <MudTextField Label="Características"
                                  @bind-Value="userDTO.CaracteristicaB"
                                  For="@(() => userDTO.CaracteristicaB)" />
                    <MudTextField Label="Características"
                                  @bind-Value="userDTO.CaracteristicaC"
                                  For="@(() => userDTO.CaracteristicaC)" />

                    <MudRadioGroup @bind-Value="UserType.">
                        <MudRadio Value="Operador" Color="Color.Primary" Dense="true">Operador</MudRadio>
                        <MudRadio Value="Tecnico" Color="Color.Secondary" Dense="false">Tecnico</MudRadio>
                    </MudRadioGroup>

                     <MudAutocomplete T="Empresa"
                                     Label="Empresa"
                                     Placeholder="--Seleccione una Empresa--"
                                     SearchFunc="SearchEmpresa"
                                     Value="selectedempresa"
                                     ValueChanged="EmpresaChanged"
                                     ToStringFunc="@(e=> e==null?null : $"{e.Name}")">
                        <ItemTemplate Context="itemContext">
                            @itemContext.Name
                        </ItemTemplate>
                    </MudAutocomplete>
                    @*                    <MudAutocomplete T="State"
                                     Label="Estado"
                                     Placeholder="--Seleccione un Estado--"
                                     SearchFunc="SearchStates"
                                     Value="selectedState"
                                     ValueChanged="StateChangedAsync"
                                     ToStringFunc="@(e=> e==null?null : $"{e.Name}")">
                        <ItemTemplate Context="itemContext">
                            @itemContext.Name
                        </ItemTemplate>
                    </MudAutocomplete>
                    <MudAutocomplete T="City"
                                     Label="Ciudad"
                                     Placeholder="--Seleccione una Ciudad--"
                                     SearchFunc="SearchCity"
                                     Value="selectedCity"
                                     ValueChanged="CityChanged"
                                     ToStringFunc="@(e=> e==null?null : $"{e.Name}")">
                        <ItemTemplate Context="itemContext">
                            @itemContext.Name
                        </ItemTemplate>
                    </MudAutocomplete>
 *@                </MudCardContent>
                <MudItem xs="12" sm="6">
                    <InputImg Label="Foto" ImageSelected="ImageSelected" ImageURL="@imageUrl" />
                </MudItem>
            </MudItem>
            <MudItem xs="12" Class="d-flex justify-center mt-2">
                <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.ArrowBack" Color="Color.Info" OnClick="ReturnAction" Class="ms-2 me-2 mb-2">
                    Regresar
                </MudButton>
                <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.Check" Color="Color.Primary" ButtonType="ButtonType.Submit" Class="mb-2">
                    Guardar
                </MudButton>
            </MudItem>
        </MudGrid>
    </EditForm>
}



